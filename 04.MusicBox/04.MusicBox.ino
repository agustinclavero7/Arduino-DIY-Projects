#include <Wire.h>             //I2C pins: nano → SDA A4, SCL A5
                              //          mega → SDA 20, SCL 21
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>
#include <DFRobotDFPlayerMini.h>
#include <SoftwareSerial.h>

//Oled Screen
#define NOTE_DELAY   42
#define NOTE_COUNT  (sizeof(musicNote) / sizeof(musicNote[0]))
#define NOTE_WIDTH   48
#define NOTE_HEIGHT  48
#define DURATION     30 
int frame = 0;

//DFplayer
#define RX_PIN      15//Para nano 0 y 1, Mega 10 y 11
#define TX_PIN      14
#define PLAY_BUTTON 3
#define FW_BUTTON   2
#define RW_BUTTON   4
#define VOL_PIN     A15
bool reproduciendo = true;
int currentPoteValue = analogRead(VOL_PIN);
int prevPoteValue = currentPoteValue;
int voLevel;

Adafruit_SSD1306 oledScreen(128,64,&Wire,4);
SoftwareSerial softSerial (RX_PIN,TX_PIN);
DFRobotDFPlayerMini mp3Player;

const byte PROGMEM musicNote[][512] = {
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,240,0,0,0,0,255,248,0,0,0,3,240,24,0,0,0,7,128,28,0,0,0,14,0,12,0,0,0,24,0,124,0,0,0,48,15,248,0,0,0,112,15,192,0,0,0,96,24,3,255,128,0,192,31,255,255,128,1,192,15,254,1,192,1,128,0,0,0,192,1,128,0,0,0,192,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,240,0,0,0,0,255,248,0,0,0,3,240,24,0,0,0,7,128,28,0,0,0,14,0,12,0,0,0,24,0,124,0,0,0,48,15,248,0,0,0,112,15,192,0,0,0,96,24,3,255,128,0,192,31,255,255,128,1,192,15,254,1,192,1,128,0,0,0,192,1,128,0,0,0,192,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,240,0,0,0,0,255,248,0,0,0,3,240,24,0,0,0,7,128,28,0,0,0,14,0,12,0,0,0,24,0,124,0,0,0,48,15,248,0,0,0,112,15,192,0,0,0,96,24,3,255,128,0,192,31,255,255,128,1,192,15,254,1,192,1,128,0,0,0,192,1,128,0,0,0,192,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,240,0,0,0,0,255,248,0,0,0,3,240,24,0,0,0,7,128,28,0,0,0,14,0,12,0,0,0,24,0,124,0,0,0,48,15,248,0,0,0,112,15,192,0,0,0,96,24,3,255,128,0,192,31,255,255,128,1,192,15,254,1,192,1,128,0,0,0,192,1,128,0,0,0,192,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,192,0,0,0,0,127,248,0,0,0,1,255,60,0,0,0,7,192,12,0,0,0,15,0,12,0,0,0,28,0,28,0,0,0,56,1,248,0,0,0,112,3,240,0,0,0,96,7,0,12,0,0,192,3,255,255,128,1,192,1,255,255,128,1,128,0,0,1,192,1,128,0,0,0,192,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,224,0,0,0,0,63,252,0,0,0,1,255,158,0,0,0,7,224,6,0,0,0,15,0,7,0,0,0,28,0,30,0,0,0,56,0,60,0,0,0,96,0,60,0,0,0,224,0,31,192,0,0,192,0,7,255,0,1,128,0,0,63,128,1,128,0,0,1,192,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,0,0,31,254,0,0,0,0,255,207,0,0,0,7,240,3,128,0,0,15,128,1,128,0,0,62,0,1,128,0,0,120,0,1,240,0,0,112,0,0,252,0,0,192,0,0,31,0,1,192,0,0,7,128,1,128,0,0,1,128,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,254,0,0,0,0,127,255,0,0,0,1,254,3,128,0,0,7,192,1,192,0,0,31,0,0,224,0,0,56,0,0,124,0,0,112,0,0,31,0,0,224,0,0,3,192,1,192,0,0,1,192,1,128,0,0,0,192,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,128,0,0,0,0,127,240,0,0,0,0,240,124,0,30,0,1,128,31,128,63,0,1,128,3,248,243,128,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,224,236,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,224,236,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,241,204,51,15,199,57,252,204,51,26,227,51,172,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,3,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,224,236,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,188,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,28,204,51,31,195,49,252,204,51,143,198,25,249,204,49,128,14,28,3,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,224,236,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,140,204,51,31,195,49,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,224,236,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,29,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,140,204,51,31,195,49,252,204,51,143,198,25,249,204,49,128,14,28,3,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,224,236,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,24,227,51,220,204,51,24,99,51,12,204,51,24,99,51,12,204,51,28,99,51,140,204,51,31,195,49,252,204,51,143,198,25,249,204,49,128,14,28,3,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,224,236,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,29,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,140,204,51,31,195,49,252,204,51,143,198,25,249,204,49,128,14,28,3,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,224,236,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,140,204,51,31,195,49,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,224,236,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,188,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,28,204,51,31,195,49,252,204,51,143,198,25,249,204,49,128,14,28,3,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,224,236,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,241,204,51,15,199,57,252,204,51,26,227,51,172,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,3,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,224,236,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,128,0,0,0,0,127,240,0,0,0,0,240,124,0,30,0,1,128,31,128,63,0,1,128,3,248,243,128,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,254,0,0,0,0,127,255,0,0,0,1,254,3,128,0,0,7,192,1,192,0,0,31,0,0,224,0,0,56,0,0,124,0,0,112,0,0,31,0,0,224,0,0,3,192,1,192,0,0,1,192,1,128,0,0,0,192,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,0,0,31,254,0,0,0,0,255,207,0,0,0,7,240,3,128,0,0,15,128,1,128,0,0,62,0,1,128,0,0,120,0,1,240,0,0,112,0,0,252,0,0,192,0,0,31,0,1,192,0,0,7,128,1,128,0,0,1,128,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,224,0,0,0,0,63,252,0,0,0,1,255,158,0,0,0,7,224,6,0,0,0,15,0,7,0,0,0,28,0,30,0,0,0,56,0,60,0,0,0,96,0,60,0,0,0,224,0,31,192,0,0,192,0,7,255,0,1,128,0,0,63,128,1,128,0,0,1,192,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,192,0,0,0,0,127,248,0,0,0,1,255,60,0,0,0,7,192,12,0,0,0,15,0,12,0,0,0,28,0,28,0,0,0,56,1,248,0,0,0,112,3,240,0,0,0,96,7,0,12,0,0,192,3,255,255,128,1,192,1,255,255,128,1,128,0,0,1,192,1,128,0,0,0,192,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,240,0,0,0,0,255,248,0,0,0,3,240,24,0,0,0,7,128,28,0,0,0,14,0,12,0,0,0,24,0,124,0,0,0,48,15,248,0,0,0,112,15,192,0,0,0,96,24,3,255,128,0,192,31,255,255,128,1,192,15,254,1,192,1,128,0,0,0,192,1,128,0,0,0,192,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,240,0,0,0,0,255,248,0,0,0,3,240,24,0,0,0,7,128,28,0,0,0,14,0,12,0,0,0,24,0,124,0,0,0,48,15,248,0,0,0,112,15,192,0,0,0,96,24,3,255,128,0,192,31,255,255,128,1,192,15,254,1,192,1,128,0,0,0,192,1,128,0,0,0,192,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,240,0,0,0,0,255,248,0,0,0,3,240,24,0,0,0,7,128,28,0,0,0,14,0,12,0,0,0,24,0,124,0,0,0,48,15,248,0,0,0,112,15,192,0,0,0,96,24,3,255,128,0,192,31,255,255,128,1,192,15,254,1,192,1,128,0,0,0,192,1,128,0,0,0,192,63,255,255,255,255,252,63,255,255,255,255,252,51,3,255,255,192,204,51,3,255,255,192,204,51,0,0,0,0,204,51,0,0,0,0,204,51,0,0,0,0,204,51,15,128,0,0,204,51,63,240,1,248,204,51,120,120,7,254,204,51,224,28,15,15,204,51,192,14,28,3,204,51,135,134,24,249,204,51,15,199,57,252,204,51,26,227,51,156,204,51,24,99,51,12,204,51,24,99,51,12,204,51,24,227,51,156,204,51,31,195,51,252,204,51,143,198,25,249,204,49,128,14,28,35,140,48,224,28,14,7,12,48,240,56,7,254,12,48,63,240,3,252,12,48,31,224,0,0,12,48,0,0,0,0,12,48,0,0,0,0,12,63,255,255,255,255,252,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
};

void animation(const byte PROGMEM frames[][512], int frameWidth, int frameHeight, int frameCount, int frameDelay ){  
  oledScreen.clearDisplay();
  oledScreen.drawBitmap(40, 8, frames[frame], frameWidth, frameHeight, 1);
  oledScreen.display();
  frame = (frame + 1) % frameCount;
  delay(frameDelay);
}

void printTextOnOled(String text){
  oledScreen.clearDisplay();
  oledScreen.setTextColor(WHITE);
  oledScreen.setCursor(5,32);
  oledScreen.setTextSize(2);
  oledScreen.print(text);
  oledScreen.display();
}

void setup() {
  Wire.begin();
  Serial.begin(115200);
  softSerial.begin(9600);
  oledScreen.begin (SSD1306_SWITCHCAPVCC,0x3C);
  pinMode(PLAY_BUTTON,INPUT_PULLUP);
  pinMode(FW_BUTTON,INPUT_PULLUP);
  pinMode(RW_BUTTON,INPUT_PULLUP);
//Presentación
  oledScreen.clearDisplay();
  oledScreen.setTextColor(WHITE);
  delay(1000);
  if(!mp3Player.begin(softSerial,false,false)){
    oledScreen.setCursor(5,32);
    oledScreen.setTextSize(3);
    oledScreen.print("FAIL");
    oledScreen.display();
    while(true);
  }
  for(int count = 0; count < DURATION; count ++){
    printTextOnOled("Booting");
  }
  mp3Player.enableLoopAll();
  mp3Player.volume(15);
}

void loop() {
  if(reproduciendo == true){
    animation(musicNote,NOTE_WIDTH,NOTE_HEIGHT,NOTE_COUNT,NOTE_DELAY);
  }
  if(digitalRead(PLAY_BUTTON) == LOW && reproduciendo == true){
    reproduciendo = false;
    printTextOnOled("Pause");
    Serial.println("Pause");
    mp3Player.pause();
    delay(500);
  }
  else if(digitalRead(PLAY_BUTTON) == LOW && reproduciendo == false){
    reproduciendo = true;
    Serial.println("Resume");
    mp3Player.start();
    delay(500);
  }
   else if(digitalRead(FW_BUTTON) == LOW && reproduciendo == true){
    mp3Player.next();
    delay(500);
  }
  else if(digitalRead(RW_BUTTON) == LOW && reproduciendo == true){
    mp3Player.previous();
    delay(500);
  }

  currentPoteValue = analogRead(VOL_PIN);
  if(abs(currentPoteValue - prevPoteValue) > 5){
    voLevel = map(currentPoteValue,0,1023,0,30);
    mp3Player.volume(voLevel);
    prevPoteValue = currentPoteValue;
  }

}
